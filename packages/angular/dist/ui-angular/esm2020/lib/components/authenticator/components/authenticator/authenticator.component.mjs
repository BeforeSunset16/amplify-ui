import { Component, ContentChildren, Input, ViewEncapsulation, } from '@angular/core';
import { authenticatorTextUtil, setUserAgent, } from '@aws-amplify/ui';
import { AmplifySlotDirective } from '../../../../utilities/amplify-slot/amplify-slot.directive';
import { CustomComponentsService } from '../../../../services/custom-components.service';
import { VERSION } from '../../../../../version';
import * as i0 from "@angular/core";
import * as i1 from "../../../../services/authenticator.service";
import * as i2 from "../../../../services/custom-components.service";
import * as i3 from "@angular/common";
import * as i4 from "../../../../utilities/amplify-slot/amplify-slot.component";
import * as i5 from "../confirm-reset-password/amplify-confirm-reset-password.component";
import * as i6 from "../confirm-sign-in/confirm-sign-in.component";
import * as i7 from "../confirm-sign-up/confirm-sign-up.component";
import * as i8 from "../confirm-verify-user/amplify-confirm-verify-user.component";
import * as i9 from "../force-new-password/force-new-password.component";
import * as i10 from "../forgot-password/forgot-password.component";
import * as i11 from "../setup-totp/setup-totp.component";
import * as i12 from "../sign-in/sign-in.component";
import * as i13 from "../sign-up/sign-up.component";
import * as i14 from "../../../../primitives/tab-item/tab-item.component";
import * as i15 from "../../../../primitives/tabs/tabs.component";
import * as i16 from "../verify-user/verify-user.component";
const { getSignInTabText, getSignUpTabText } = authenticatorTextUtil;
export class AuthenticatorComponent {
    constructor(authenticator, contextService, changeDetector) {
        this.authenticator = authenticator;
        this.contextService = contextService;
        this.changeDetector = changeDetector;
        this.customComponentQuery = null;
        // translated texts
        this.signInTitle = getSignInTabText();
        this.signUpTitle = getSignUpTabText();
        this.hasInitialized = false;
        this.isHandlingHubEvent = false;
    }
    // context passed to "authenticated" slot
    get context() {
        return this.authenticator.slotContext;
    }
    get route() {
        return this.authenticator.route;
    }
    ngOnInit() {
        const { initialState, loginMechanisms, services, signUpAttributes, socialProviders, formFields, } = this;
        this.clearUserAgent = setUserAgent({
            componentName: 'Authenticator',
            packageName: 'angular',
            version: VERSION,
        });
        const { initializeMachine } = this.authenticator;
        this.authenticator.hubSubject.subscribe(() => {
            /*
             * Hub events aren't properly caught by Angular, because they are
             * synchronous events. Angular tracks async network events and
             * html events, but not synchronous events like hub.
             *
             * On any notable hub events, we run change detection manually.
             */
            this.changeDetector.detectChanges();
            /*
             * Hub events that we handle can lead to multiple state changes:
             * e.g. `authenticated` -> `signOut` -> initialState.
             *
             * We want to ensure change detection runs all the way, until
             * we reach back to the initial state. Setting the below flag
             * to true to until we reach initial state.
             */
            this.isHandlingHubEvent = true;
        });
        /**
         * Subscribes to state machine changes and sends INIT event
         * once machine reaches 'setup' state.
         */
        this.unsubscribeMachine = this.authenticator.subscribe(() => {
            const { route } = this.authenticator;
            if (this.isHandlingHubEvent) {
                this.changeDetector.detectChanges();
                const initialStateWithDefault = initialState ?? 'signIn';
                // We can stop manual change detection if we're back to the initial state
                if (route === initialStateWithDefault) {
                    this.isHandlingHubEvent = false;
                }
            }
            if (!this.hasInitialized && route === 'setup') {
                initializeMachine({
                    initialState,
                    loginMechanisms,
                    services,
                    signUpAttributes,
                    socialProviders,
                    formFields,
                });
                this.hasInitialized = true;
            }
        }).unsubscribe;
        /**
         * handling translations after content init, because authenticator and its
         * translations might be initialized before the main app's `ngOnInit` is run.
         */
        this.signInTitle = getSignInTabText();
        this.signUpTitle = getSignUpTabText();
    }
    /**
     * Lifecycle Methods
     */
    ngAfterContentInit() {
        this.contextService.customComponents = this.mapCustomComponents(this.customComponentQuery);
    }
    ngOnDestroy() {
        this.clearUserAgent();
        if (this.unsubscribeMachine)
            this.unsubscribeMachine();
    }
    /**
     * Class Functions
     */
    onTabChange() {
        const { route } = this.authenticator;
        if (route === 'signIn') {
            this.authenticator.toSignUp();
        }
        else {
            this.authenticator.toSignIn();
        }
    }
    hasTabs() {
        const { route } = this.authenticator;
        return route === 'signIn' || route === 'signUp';
    }
    hasRouteComponent() {
        const { route } = this.authenticator;
        switch (route) {
            case 'authenticated':
            case 'idle':
            case 'setup':
            case 'signOut':
            case 'transition':
                return false;
            default:
                return true;
        }
    }
    mapCustomComponents(componentQuery) {
        if (!componentQuery)
            return {};
        const customComponents = {};
        componentQuery.forEach((component) => {
            customComponents[component.name] = component.template;
        });
        return customComponents;
    }
}
AuthenticatorComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: AuthenticatorComponent, deps: [{ token: i1.AuthenticatorService }, { token: i2.CustomComponentsService }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
AuthenticatorComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.3.0", type: AuthenticatorComponent, selector: "amplify-authenticator", inputs: { formFields: "formFields", initialState: "initialState", loginMechanisms: "loginMechanisms", services: "services", signUpAttributes: "signUpAttributes", socialProviders: "socialProviders", variation: "variation", hideSignUp: "hideSignUp" }, providers: [CustomComponentsService], queries: [{ propertyName: "customComponentQuery", predicate: AmplifySlotDirective }], ngImport: i0, template: "<div\n  data-amplify-authenticator\n  [attr.data-variation]=\"variation\"\n  *ngIf=\"hasRouteComponent()\"\n>\n  <div data-amplify-container>\n    <amplify-slot name=\"header\" [context]=\"context\"></amplify-slot>\n    <div\n      data-amplify-router\n      [attr.data-amplify-router-content]=\"hasTabs() ? undefined : ''\"\n    >\n      <amplify-tabs\n        (tabChange)=\"onTabChange()\"\n        *ngIf=\"(route === 'signIn' || route === 'signUp') && !hideSignUp\"\n      >\n        <amplify-tab-item\n          [title]=\"signInTitle\"\n          [active]=\"route === 'signIn'\"\n          data-amplify-router-content\n        >\n          <!-- signIn component -->\n          <amplify-slot\n            name=\"sign-in\"\n            [context]=\"context\"\n            *ngIf=\"route === 'signIn'\"\n          >\n            <amplify-sign-in></amplify-sign-in>\n          </amplify-slot>\n        </amplify-tab-item>\n        <amplify-tab-item\n          [title]=\"signUpTitle\"\n          [active]=\"route === 'signUp'\"\n          data-amplify-router-content\n        >\n          <!-- signUp component -->\n          <amplify-slot\n            name=\"sign-up\"\n            [context]=\"context\"\n            *ngIf=\"route === 'signUp'\"\n          >\n            <amplify-sign-up></amplify-sign-up>\n          </amplify-slot>\n        </amplify-tab-item>\n      </amplify-tabs>\n\n      <amplify-slot\n        name=\"sign-in\"\n        [context]=\"context\"\n        *ngIf=\"route === 'signIn' && hideSignUp\"\n      >\n        <amplify-sign-in></amplify-sign-in>\n      </amplify-slot>\n\n      <!-- confirmSignUp content -->\n      <amplify-slot\n        name=\"confirm-sign-up\"\n        [context]=\"context\"\n        *ngIf=\"route === 'confirmSignUp'\"\n      >\n        <amplify-confirm-sign-up></amplify-confirm-sign-up>\n      </amplify-slot>\n\n      <!-- confirmSignIn content -->\n      <amplify-slot\n        name=\"confirm-sign-in\"\n        [context]=\"context\"\n        *ngIf=\"route === 'confirmSignIn'\"\n      >\n        <amplify-confirm-sign-in></amplify-confirm-sign-in>\n      </amplify-slot>\n\n      <!-- setupTotp content -->\n      <amplify-slot\n        name=\"setup-totp\"\n        [context]=\"context\"\n        *ngIf=\"route === 'setupTotp'\"\n      >\n        <amplify-setup-totp></amplify-setup-totp>\n      </amplify-slot>\n\n      <!-- forceNewPassword content -->\n      <amplify-slot\n        name=\"force-new-password\"\n        [context]=\"context\"\n        *ngIf=\"route === 'forceNewPassword'\"\n      >\n        <amplify-force-new-password></amplify-force-new-password>\n      </amplify-slot>\n\n      <!-- forgotPassword content -->\n      <amplify-slot\n        name=\"forgot-password\"\n        [context]=\"context\"\n        *ngIf=\"route === 'forgotPassword'\"\n      >\n        <amplify-forgot-password></amplify-forgot-password>\n      </amplify-slot>\n\n      <!-- confirmResetPassword content -->\n      <amplify-slot\n        name=\"confirm-reset-password\"\n        [context]=\"context\"\n        *ngIf=\"route === 'confirmResetPassword'\"\n      >\n        <amplify-confirm-reset-password></amplify-confirm-reset-password>\n      </amplify-slot>\n\n      <!-- verifyUser content -->\n      <amplify-slot\n        name=\"verify-user\"\n        [context]=\"context\"\n        *ngIf=\"route === 'verifyUser'\"\n      >\n        <amplify-verify-user></amplify-verify-user>\n      </amplify-slot>\n\n      <!-- confirmVerifyUser content -->\n      <amplify-slot\n        name=\"confirm-verify-user\"\n        [context]=\"context\"\n        *ngIf=\"route === 'confirmVerifyUser'\"\n      >\n        <amplify-confirm-verify-user></amplify-confirm-verify-user>\n      </amplify-slot>\n    </div>\n\n    <amplify-slot name=\"footer\" [context]=\"context\"></amplify-slot>\n  </div>\n</div>\n\n<!-- signedIn content is rendered outside authenticator so it's not styled by authenticator -->\n<amplify-slot\n  name=\"authenticated\"\n  [context]=\"context\"\n  *ngIf=\"route === 'authenticated'\"\n>\n  <ng-content></ng-content>\n</amplify-slot>\n", dependencies: [{ kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i4.AmplifySlotComponent, selector: "amplify-slot", inputs: ["name", "context"] }, { kind: "component", type: i5.ConfirmResetPasswordComponent, selector: "amplify-confirm-reset-password", inputs: ["headerText"] }, { kind: "component", type: i6.ConfirmSignInComponent, selector: "amplify-confirm-sign-in" }, { kind: "component", type: i7.ConfirmSignUpComponent, selector: "amplify-confirm-sign-up" }, { kind: "component", type: i8.ConfirmVerifyUserComponent, selector: "amplify-confirm-verify-user", inputs: ["headerText"] }, { kind: "component", type: i9.ForceNewPasswordComponent, selector: "amplify-force-new-password", inputs: ["headerText"] }, { kind: "component", type: i10.ForgotPasswordComponent, selector: "amplify-forgot-password", inputs: ["headerText"] }, { kind: "component", type: i11.SetupTotpComponent, selector: "amplify-setup-totp" }, { kind: "component", type: i12.SignInComponent, selector: "amplify-sign-in" }, { kind: "component", type: i13.SignUpComponent, selector: "amplify-sign-up" }, { kind: "component", type: i14.TabItemComponent, selector: "amplify-tab-item", inputs: ["title", "active", "id", "labelledById", "tabIndex"] }, { kind: "component", type: i15.TabsComponent, selector: "amplify-tabs", outputs: ["tabChange"] }, { kind: "component", type: i16.VerifyUserComponent, selector: "amplify-verify-user", inputs: ["headerText"] }], encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: AuthenticatorComponent, decorators: [{
            type: Component,
            args: [{ selector: 'amplify-authenticator', providers: [CustomComponentsService], encapsulation: ViewEncapsulation.None, template: "<div\n  data-amplify-authenticator\n  [attr.data-variation]=\"variation\"\n  *ngIf=\"hasRouteComponent()\"\n>\n  <div data-amplify-container>\n    <amplify-slot name=\"header\" [context]=\"context\"></amplify-slot>\n    <div\n      data-amplify-router\n      [attr.data-amplify-router-content]=\"hasTabs() ? undefined : ''\"\n    >\n      <amplify-tabs\n        (tabChange)=\"onTabChange()\"\n        *ngIf=\"(route === 'signIn' || route === 'signUp') && !hideSignUp\"\n      >\n        <amplify-tab-item\n          [title]=\"signInTitle\"\n          [active]=\"route === 'signIn'\"\n          data-amplify-router-content\n        >\n          <!-- signIn component -->\n          <amplify-slot\n            name=\"sign-in\"\n            [context]=\"context\"\n            *ngIf=\"route === 'signIn'\"\n          >\n            <amplify-sign-in></amplify-sign-in>\n          </amplify-slot>\n        </amplify-tab-item>\n        <amplify-tab-item\n          [title]=\"signUpTitle\"\n          [active]=\"route === 'signUp'\"\n          data-amplify-router-content\n        >\n          <!-- signUp component -->\n          <amplify-slot\n            name=\"sign-up\"\n            [context]=\"context\"\n            *ngIf=\"route === 'signUp'\"\n          >\n            <amplify-sign-up></amplify-sign-up>\n          </amplify-slot>\n        </amplify-tab-item>\n      </amplify-tabs>\n\n      <amplify-slot\n        name=\"sign-in\"\n        [context]=\"context\"\n        *ngIf=\"route === 'signIn' && hideSignUp\"\n      >\n        <amplify-sign-in></amplify-sign-in>\n      </amplify-slot>\n\n      <!-- confirmSignUp content -->\n      <amplify-slot\n        name=\"confirm-sign-up\"\n        [context]=\"context\"\n        *ngIf=\"route === 'confirmSignUp'\"\n      >\n        <amplify-confirm-sign-up></amplify-confirm-sign-up>\n      </amplify-slot>\n\n      <!-- confirmSignIn content -->\n      <amplify-slot\n        name=\"confirm-sign-in\"\n        [context]=\"context\"\n        *ngIf=\"route === 'confirmSignIn'\"\n      >\n        <amplify-confirm-sign-in></amplify-confirm-sign-in>\n      </amplify-slot>\n\n      <!-- setupTotp content -->\n      <amplify-slot\n        name=\"setup-totp\"\n        [context]=\"context\"\n        *ngIf=\"route === 'setupTotp'\"\n      >\n        <amplify-setup-totp></amplify-setup-totp>\n      </amplify-slot>\n\n      <!-- forceNewPassword content -->\n      <amplify-slot\n        name=\"force-new-password\"\n        [context]=\"context\"\n        *ngIf=\"route === 'forceNewPassword'\"\n      >\n        <amplify-force-new-password></amplify-force-new-password>\n      </amplify-slot>\n\n      <!-- forgotPassword content -->\n      <amplify-slot\n        name=\"forgot-password\"\n        [context]=\"context\"\n        *ngIf=\"route === 'forgotPassword'\"\n      >\n        <amplify-forgot-password></amplify-forgot-password>\n      </amplify-slot>\n\n      <!-- confirmResetPassword content -->\n      <amplify-slot\n        name=\"confirm-reset-password\"\n        [context]=\"context\"\n        *ngIf=\"route === 'confirmResetPassword'\"\n      >\n        <amplify-confirm-reset-password></amplify-confirm-reset-password>\n      </amplify-slot>\n\n      <!-- verifyUser content -->\n      <amplify-slot\n        name=\"verify-user\"\n        [context]=\"context\"\n        *ngIf=\"route === 'verifyUser'\"\n      >\n        <amplify-verify-user></amplify-verify-user>\n      </amplify-slot>\n\n      <!-- confirmVerifyUser content -->\n      <amplify-slot\n        name=\"confirm-verify-user\"\n        [context]=\"context\"\n        *ngIf=\"route === 'confirmVerifyUser'\"\n      >\n        <amplify-confirm-verify-user></amplify-confirm-verify-user>\n      </amplify-slot>\n    </div>\n\n    <amplify-slot name=\"footer\" [context]=\"context\"></amplify-slot>\n  </div>\n</div>\n\n<!-- signedIn content is rendered outside authenticator so it's not styled by authenticator -->\n<amplify-slot\n  name=\"authenticated\"\n  [context]=\"context\"\n  *ngIf=\"route === 'authenticated'\"\n>\n  <ng-content></ng-content>\n</amplify-slot>\n" }]
        }], ctorParameters: function () { return [{ type: i1.AuthenticatorService }, { type: i2.CustomComponentsService }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { formFields: [{
                type: Input
            }], initialState: [{
                type: Input
            }], loginMechanisms: [{
                type: Input
            }], services: [{
                type: Input
            }], signUpAttributes: [{
                type: Input
            }], socialProviders: [{
                type: Input
            }], variation: [{
                type: Input
            }], hideSignUp: [{
                type: Input
            }], customComponentQuery: [{
                type: ContentChildren,
                args: [AmplifySlotDirective]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aGVudGljYXRvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy91aS1hbmd1bGFyL3NyYy9saWIvY29tcG9uZW50cy9hdXRoZW50aWNhdG9yL2NvbXBvbmVudHMvYXV0aGVudGljYXRvci9hdXRoZW50aWNhdG9yLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VpLWFuZ3VsYXIvc3JjL2xpYi9jb21wb25lbnRzL2F1dGhlbnRpY2F0b3IvY29tcG9uZW50cy9hdXRoZW50aWNhdG9yL2F1dGhlbnRpY2F0b3IuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUdMLFNBQVMsRUFDVCxlQUFlLEVBQ2YsS0FBSyxFQUtMLGlCQUFpQixHQUNsQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBRUwscUJBQXFCLEVBQ3JCLFlBQVksR0FFYixNQUFNLGlCQUFpQixDQUFDO0FBQ3pCLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJEQUEyRCxDQUFDO0FBQ2pHLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLGdEQUFnRCxDQUFDO0FBRXpGLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRWpELE1BQU0sRUFBRSxnQkFBZ0IsRUFBRSxnQkFBZ0IsRUFBRSxHQUFHLHFCQUFxQixDQUFDO0FBUXJFLE1BQU0sT0FBTyxzQkFBc0I7SUF3QmpDLFlBQ1UsYUFBbUMsRUFDbkMsY0FBdUMsRUFDdkMsY0FBaUM7UUFGakMsa0JBQWEsR0FBYixhQUFhLENBQXNCO1FBQ25DLG1CQUFjLEdBQWQsY0FBYyxDQUF5QjtRQUN2QyxtQkFBYyxHQUFkLGNBQWMsQ0FBbUI7UUFkbkMseUJBQW9CLEdBQW9DLElBQUksQ0FBQztRQUVyRSxtQkFBbUI7UUFDWixnQkFB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Z0JBQ0csZUFBZTtzQkFBdkIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLGdCQUFnQjtzQkFBeEIsS0FBSztnQkFDRyxlQUFlO3NCQUF2QixLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUs7Z0JBQ0csVUFBVTtzQkFBbEIsS0FBSztnQkFHRSxvQkFBb0I7c0JBRDNCLGVBQWU7dUJBQUMsb0JBQW9CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbXBvbmVudCxcbiAgQ29udGVudENoaWxkcmVuLFxuICBJbnB1dCxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIFF1ZXJ5TGlzdCxcbiAgVGVtcGxhdGVSZWYsXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEF1dGhlbnRpY2F0b3JNYWNoaW5lT3B0aW9ucyxcbiAgYXV0aGVudGljYXRvclRleHRVdGlsLFxuICBzZXRVc2VyQWdlbnQsXG4gIFNvY2lhbFByb3ZpZGVyLFxufSBmcm9tICdAYXdzLWFtcGxpZnkvdWknO1xuaW1wb3J0IHsgQW1wbGlmeVNsb3REaXJlY3RpdmUgfSBmcm9tICcuLi8uLi8uLi8uLi91dGlsaXRpZXMvYW1wbGlmeS1zbG90L2FtcGxpZnktc2xvdC5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgQ3VzdG9tQ29tcG9uZW50c1NlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi8uLi9zZXJ2aWNlcy9jdXN0b20tY29tcG9uZW50cy5zZXJ2aWNlJztcbmltcG9ydCB7IEF1dGhlbnRpY2F0b3JTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2VydmljZXMvYXV0aGVudGljYXRvci5zZXJ2aWNlJztcbmltcG9ydCB7IFZFUlNJT04gfSBmcm9tICcuLi8uLi8uLi8uLi8uLi92ZXJzaW9uJztcblxuY29uc3QgeyBnZXRTaWduSW5UYWJUZXh0LCBnZXRTaWduVXBUYWJUZXh0IH0gPSBhdXRoZW50aWNhdG9yVGV4dFV0aWw7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2FtcGxpZnktYXV0aGVudGljYXRvcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9hdXRoZW50aWNhdG9yLmNvbXBvbmVudC5odG1sJyxcbiAgcHJvdmlkZXJzOiBbQ3VzdG9tQ29tcG9uZW50c1NlcnZpY2VdLCAvLyBtYWtlIHN1cmUgY3VzdG9tIGNvbXBvbmVudHMgYXJlIHNjb3BlZCB0byB0aGlzIGF1dGhlbnRpY2F0b3Igb25seVxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxufSlcbmV4cG9ydCBjbGFzcyBBdXRoZW50aWNhdG9yQ29tcG9uZW50XG4gIGltcGxlbWVudHMgT25Jbml0LCBBZnRlckNvbnRlbnRJbml0LCBPbkRlc3Ryb3lcbntcbiAgQElucHV0KCkgZm9ybUZpZWxkczogQXV0aGVudGljYXRvck1hY2hpbmVPcHRpb25zWydmb3JtRmllbGRzJ107XG4gIEBJbnB1dCgpIGluaXRpYWxTdGF0ZTogQXV0aGVudGljYXRvck1hY2hpbmVPcHRpb25zWydpbml0aWFsU3RhdGUnXTtcbiAgQElucHV0KCkgbG9naW5NZWNoYW5pc21zOiBBdXRoZW50aWNhdG9yTWFjaGluZU9wdGlvbnNbJ2xvZ2luTWVjaGFuaXNtcyddO1xuICBASW5wdXQoKSBzZXJ2aWNlczogQXV0aGVudGljYXRvck1hY2hpbmVPcHRpb25zWydzZXJ2aWNlcyddO1xuICBASW5wdXQoKSBzaWduVXBBdHRyaWJ1dGVzOiBBdXRoZW50aWNhdG9yTWFjaGluZU9wdGlvbnNbJ3NpZ25VcEF0dHJpYnV0ZXMnXTtcbiAgQElucHV0KCkgc29jaWFsUHJvdmlkZXJzOiBTb2NpYWxQcm92aWRlcltdO1xuICBASW5wdXQoKSB2YXJpYXRpb246ICdkZWZhdWx0JyB8ICdtb2RhbCc7XG4gIEBJbnB1dCgpIGhpZGVTaWduVXA6IGJvb2xlYW47XG5cbiAgQENvbnRlbnRDaGlsZHJlbihBbXBsaWZ5U2xvdERpcmVjdGl2ZSlcbiAgcHJpdmF0ZSBjdXN0b21Db21wb25lbnRRdWVyeTogUXVlcnlMaXN0PEFtcGxpZnlTbG90RGlyZWN0aXZlPiA9IG51bGw7XG5cbiAgLy8gdHJhbnNsYXRlZCB0ZXh0c1xuICBwdWJsaWMgc2lnbkluVGl0bGUgPSBnZXRTaWduSW5UYWJUZXh0KCk7XG4gIHB1YmxpYyBzaWduVXBUaXRsZSA9IGdldFNpZ25VcFRhYlRleHQoKTtcblxuICBwcml2YXRlIGhhc0luaXRpYWxpemVkID0gZmFsc2U7XG4gIHByaXZhdGUgaXNIYW5kbGluZ0h1YkV2ZW50ID0gZmFsc2U7XG4gIHByaXZhdGUgdW5zdWJzY3JpYmVNYWNoaW5lOiAoKSA9PiB2b2lkO1xuICBwcml2YXRlIGNsZWFyVXNlckFnZW50OiAoKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgYXV0aGVudGljYXRvcjogQXV0aGVudGljYXRvclNlcnZpY2UsXG4gICAgcHJpdmF0ZSBjb250ZXh0U2VydmljZTogQ3VzdG9tQ29tcG9uZW50c1NlcnZpY2UsXG4gICAgcHJpdmF0ZSBjaGFuZ2VEZXRlY3RvcjogQ2hhbmdlRGV0ZWN0b3JSZWZcbiAgKSB7fVxuXG4gIC8vIGNvbnRleHQgcGFzc2VkIHRvIFwiYXV0aGVudGljYXRlZFwiIHNsb3RcbiAgcHVibGljIGdldCBjb250ZXh0KCk6IEF1dGhlbnRpY2F0b3JTZXJ2aWNlWydzbG90Q29udGV4dCddIHtcbiAgICByZXR1cm4gdGhpcy5hdXRoZW50aWNhdG9yLnNsb3RDb250ZXh0O1xuICB9XG5cbiAgcHVibGljIGdldCByb3V0ZSgpOiBBdXRoZW50aWNhdG9yU2VydmljZVsncm91dGUnXSB7XG4gICAgcmV0dXJuIHRoaXMuYXV0aGVudGljYXRvci5yb3V0ZTtcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIGNvbnN0IHtcbiAgICAgIGluaXRpYWxTdGF0ZSxcbiAgICAgIGxvZ2luTWVjaGFuaXNtcyxcbiAgICAgIHNlcnZpY2VzLFxuICAgICAgc2lnblVwQXR0cmlidXRlcyxcbiAgICAgIHNvY2lhbFByb3ZpZGVycyxcbiAgICAgIGZvcm1GaWVsZHMsXG4gICAgfSA9IHRoaXM7XG5cbiAgICB0aGlzLmNsZWFyVXNlckFnZW50ID0gc2V0VXNlckFnZW50KHtcbiAgICAgIGNvbXBvbmVudE5hbWU6ICdBdXRoZW50aWNhdG9yJyxcbiAgICAgIHBhY2thZ2VOYW1lOiAnYW5ndWxhcicsXG4gICAgICB2ZXJzaW9uOiBWRVJTSU9OLFxuICAgIH0pO1xuXG4gICAgY29uc3QgeyBpbml0aWFsaXplTWFjaGluZSB9ID0gdGhpcy5hdXRoZW50aWNhdG9yO1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdG9yLmh1YlN1YmplY3Quc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgIC8qXG4gICAgICAgKiBIdWIgZXZlbnRzIGFyZW4ndCBwcm9wZXJseSBjYXVnaHQgYnkgQW5ndWxhciwgYmVjYXVzZSB0aGV5IGFyZVxuICAgICAgICogc3luY2hyb25vdXMgZXZlbnRzLiBBbmd1bGFyIHRyYWNrcyBhc3luYyBuZXR3b3JrIGV2ZW50cyBhbmRcbiAgICAgICAqIGh0bWwgZXZlbnRzLCBidXQgbm90IHN5bmNocm9ub3VzIGV2ZW50cyBsaWtlIGh1Yi5cbiAgICAgICAqXG4gICAgICAgKiBPbiBhbnkgbm90YWJsZSBodWIgZXZlbnRzLCB3ZSBydW4gY2hhbmdlIGRldGVjdGlvbiBtYW51YWxseS5cbiAgICAgICAqL1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5kZXRlY3RDaGFuZ2VzKCk7XG5cbiAgICAgIC8qXG4gICAgICAgKiBIdWIgZXZlbnRzIHRoYXQgd2UgaGFuZGxlIGNhbiBsZWFkIHRvIG11bHRpcGxlIHN0YXRlIGNoYW5nZXM6XG4gICAgICAgKiBlLmcuIGBhdXRoZW50aWNhdGVkYCAtPiBgc2lnbk91dGAgLT4gaW5pdGlhbFN0YXRlLlxuICAgICAgICpcbiAgICAgICAqIFdlIHdhbnQgdG8gZW5zdXJlIGNoYW5nZSBkZXRlY3Rpb24gcnVucyBhbGwgdGhlIHdheSwgdW50aWxcbiAgICAgICAqIHdlIHJlYWNoIGJhY2sgdG8gdGhlIGluaXRpYWwgc3RhdGUuIFNldHRpbmcgdGhlIGJlbG93IGZsYWdcbiAgICAgICAqIHRvIHRydWUgdG8gdW50aWwgd2UgcmVhY2ggaW5pdGlhbCBzdGF0ZS5cbiAgICAgICAqL1xuICAgICAgdGhpcy5pc0hhbmRsaW5nSHViRXZlbnQgPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlcyB0byBzdGF0ZSBtYWNoaW5lIGNoYW5nZXMgYW5kIHNlbmRzIElOSVQgZXZlbnRcbiAgICAgKiBvbmNlIG1hY2hpbmUgcmVhY2hlcyAnc2V0dXAnIHN0YXRlLlxuICAgICAqL1xuICAgIHRoaXMudW5zdWJzY3JpYmVNYWNoaW5lID0gdGhpcy5hdXRoZW50aWNhdG9yLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICBjb25zdCB7IHJvdXRlIH0gPSB0aGlzLmF1dGhlbnRpY2F0b3I7XG5cbiAgICAgIGlmICh0aGlzLmlzSGFuZGxpbmdIdWJFdmVudCkge1xuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcblxuICAgICAgICBjb25zdCBpbml0aWFsU3RhdGVXaXRoRGVmYXVsdCA9IGluaXRpYWxTdGF0ZSA/PyAnc2lnbkluJztcblxuICAgICAgICAvLyBXZSBjYW4gc3RvcCBtYW51YWwgY2hhbmdlIGRldGVjdGlvbiBpZiB3ZSdyZSBiYWNrIHRvIHRoZSBpbml0aWFsIHN0YXRlXG4gICAgICAgIGlmIChyb3V0ZSA9PT0gaW5pdGlhbFN0YXRlV2l0aERlZmF1bHQpIHtcbiAgICAgICAgICB0aGlzLmlzSGFuZGxpbmdIdWJFdmVudCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5oYXNJbml0aWFsaXplZCAmJiByb3V0ZSA9PT0gJ3NldHVwJykge1xuICAgICAgICBpbml0aWFsaXplTWFjaGluZSh7XG4gICAgICAgICAgaW5pdGlhbFN0YXRlLFxuICAgICAgICAgIGxvZ2luTWVjaGFuaXNtcyxcbiAgICAgICAgICBzZXJ2aWNlcyxcbiAgICAgICAgICBzaWduVXBBdHRyaWJ1dGVzLFxuICAgICAgICAgIHNvY2lhbFByb3ZpZGVycyxcbiAgICAgICAgICBmb3JtRmllbGRzLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmhhc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KS51bnN1YnNjcmliZTtcblxuICAgIC8qKlxuICAgICAqIGhhbmRsaW5nIHRyYW5zbGF0aW9ucyBhZnRlciBjb250ZW50IGluaXQsIGJlY2F1c2UgYXV0aGVudGljYXRvciBhbmQgaXRzXG4gICAgICogdHJhbnNsYXRpb25zIG1pZ2h0IGJlIGluaXRpYWxpemVkIGJlZm9yZSB0aGUgbWFpbiBhcHAncyBgbmdPbkluaXRgIGlzIHJ1bi5cbiAgICAgKi9cbiAgICB0aGlzLnNpZ25JblRpdGxlID0gZ2V0U2lnbkluVGFiVGV4dCgpO1xuICAgIHRoaXMuc2lnblVwVGl0bGUgPSBnZXRTaWduVXBUYWJUZXh0KCk7XG4gIH1cblxuICAvKipcbiAgICogTGlmZWN5Y2xlIE1ldGhvZHNcbiAgICovXG4gIG5nQWZ0ZXJDb250ZW50SW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRleHRTZXJ2aWNlLmN1c3RvbUNvbXBvbmVudHMgPSB0aGlzLm1hcEN1c3RvbUNvbXBvbmVudHMoXG4gICAgICB0aGlzLmN1c3RvbUNvbXBvbmVudFF1ZXJ5XG4gICAgKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuY2xlYXJVc2VyQWdlbnQoKTtcbiAgICBpZiAodGhpcy51bnN1YnNjcmliZU1hY2hpbmUpIHRoaXMudW5zdWJzY3JpYmVNYWNoaW5lKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2xhc3MgRnVuY3Rpb25zXG4gICAqL1xuICBwdWJsaWMgb25UYWJDaGFuZ2UoKTogdm9pZCB7XG4gICAgY29uc3QgeyByb3V0ZSB9ID0gdGhpcy5hdXRoZW50aWNhdG9yO1xuICAgIGlmIChyb3V0ZSA9PT0gJ3NpZ25JbicpIHtcbiAgICAgIHRoaXMuYXV0aGVudGljYXRvci50b1NpZ25VcCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmF1dGhlbnRpY2F0b3IudG9TaWduSW4oKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgaGFzVGFicygpOiBib29sZWFuIHtcbiAgICBjb25zdCB7IHJvdXRlIH0gPSB0aGlzLmF1dGhlbnRpY2F0b3I7XG4gICAgcmV0dXJuIHJvdXRlID09PSAnc2lnbkluJyB8fCByb3V0ZSA9PT0gJ3NpZ25VcCc7XG4gIH1cblxuICBwdWJsaWMgaGFzUm91dGVDb21wb25lbnQoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgeyByb3V0ZSB9ID0gdGhpcy5hdXRoZW50aWNhdG9yO1xuXG4gICAgc3dpdGNoIChyb3V0ZSkge1xuICAgICAgY2FzZSAnYXV0aGVudGljYXRlZCc6XG4gICAgICBjYXNlICdpZGxlJzpcbiAgICAgIGNhc2UgJ3NldHVwJzpcbiAgICAgIGNhc2UgJ3NpZ25PdXQnOlxuICAgICAgY2FzZSAndHJhbnNpdGlvbic6XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgbWFwQ3VzdG9tQ29tcG9uZW50cyhcbiAgICBjb21wb25lbnRRdWVyeTogUXVlcnlMaXN0PEFtcGxpZnlTbG90RGlyZWN0aXZlPlxuICApOiBSZWNvcmQ8c3RyaW5nLCBUZW1wbGF0ZVJlZjx1bmtub3duPj4ge1xuICAgIGlmICghY29tcG9uZW50UXVlcnkpIHJldHVybiB7fTtcbiAgICBjb25zdCBjdXN0b21Db21wb25lbnRzOiBSZWNvcmQ8c3RyaW5nLCBUZW1wbGF0ZVJlZjx1bmtub3duPj4gPSB7fTtcbiAgICBjb21wb25lbnRRdWVyeS5mb3JFYWNoKChjb21wb25lbnQpID0+IHtcbiAgICAgIGN1c3RvbUNvbXBvbmVudHNbY29tcG9uZW50Lm5hbWVdID0gY29tcG9uZW50LnRlbXBsYXRlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGN1c3RvbUNvbXBvbmVudHM7XG4gIH1cbn1cbiIsIjxkaXZcbiAgZGF0YS1hbXBsaWZ5LWF1dGhlbnRpY2F0b3JcbiAgW2F0dHIuZGF0YS12YXJpYXRpb25dPVwidmFyaWF0aW9uXCJcbiAgKm5nSWY9XCJoYXNSb3V0ZUNvbXBvbmVudCgpXCJcbj5cbiAgPGRpdiBkYXRhLWFtcGxpZnktY29udGFpbmVyPlxuICAgIDxhbXBsaWZ5LXNsb3QgbmFtZT1cImhlYWRlclwiIFtjb250ZXh0XT1cImNvbnRleHRcIj48L2FtcGxpZnktc2xvdD5cbiAgICA8ZGl2XG4gICAgICBkYXRhLWFtcGxpZnktcm91dGVyXG4gICAgICBbYXR0ci5kYXRhLWFtcGxpZnktcm91dGVyLWNvbnRlbnRdPVwiaGFzVGFicygpID8gdW5kZWZpbmVkIDogJydcIlxuICAgID5cbiAgICAgIDxhbXBsaWZ5LXRhYnNcbiAgICAgICAgKHRhYkNoYW5nZSk9XCJvblRhYkNoYW5nZSgpXCJcbiAgICAgICAgKm5nSWY9XCIocm91dGUgPT09ICdzaWduSW4nIHx8IHJvdXRlID09PSAnc2lnblVwJykgJiYgIWhpZGVTaWduVXBcIlxuICAgICAgPlxuICAgICAgICA8YW1wbGlmeS10YWItaXRlbVxuICAgICAgICAgIFt0aXRsZV09XCJzaWduSW5UaXRsZVwiXG4gICAgICAgICAgW2FjdGl2ZV09XCJyb3V0ZSA9PT0gJ3NpZ25JbidcIlxuICAgICAgICAgIGRhdGEtYW1wbGlmeS1yb3V0ZXItY29udGVudFxuICAgICAgICA+XG4gICAgICAgICAgPCEtLSBzaWduSW4gY29tcG9uZW50IC0tPlxuICAgICAgICAgIDxhbXBsaWZ5LXNsb3RcbiAgICAgICAgICAgIG5hbWU9XCJzaWduLWluXCJcbiAgICAgICAgICAgIFtjb250ZXh0XT1cImNvbnRleHRcIlxuICAgICAgICAgICAgKm5nSWY9XCJyb3V0ZSA9PT0gJ3NpZ25JbidcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxhbXBsaWZ5LXNpZ24taW4+PC9hbXBsaWZ5LXNpZ24taW4+XG4gICAgICAgICAgPC9hbXBsaWZ5LXNsb3Q+XG4gICAgICAgIDwvYW1wbGlmeS10YWItaXRlbT5cbiAgICAgICAgPGFtcGxpZnktdGFiLWl0ZW1cbiAgICAgICAgICBbdGl0bGVdPVwic2lnblVwVGl0bGVcIlxuICAgICAgICAgIFthY3RpdmVdPVwicm91dGUgPT09ICdzaWduVXAnXCJcbiAgICAgICAgICBkYXRhLWFtcGxpZnktcm91dGVyLWNvbnRlbnRcbiAgICAgICAgPlxuICAgICAgICAgIDwhLS0gc2lnblVwIGNvbXBvbmVudCAtLT5cbiAgICAgICAgICA8YW1wbGlmeS1zbG90XG4gICAgICAgICAgICBuYW1lPVwic2lnbi11cFwiXG4gICAgICAgICAgICBbY29udGV4dF09XCJjb250ZXh0XCJcbiAgICAgICAgICAgICpuZ0lmPVwicm91dGUgPT09ICdzaWduVXAnXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8YW1wbGlmeS1zaWduLXVwPjwvYW1wbGlmeS1zaWduLXVwPlxuICAgICAgICAgIDwvYW1wbGlmeS1zbG90PlxuICAgICAgICA8L2FtcGxpZnktdGFiLWl0ZW0+XG4gICAgICA8L2FtcGxpZnktdGFicz5cblxuICAgICAgPGFtcGxpZnktc2xvdFxuICAgICAgICBuYW1lPVwic2lnbi1pblwiXG4gICAgICAgIFtjb250ZXh0XT1cImNvbnRleHRcIlxuICAgICAgICAqbmdJZj1cInJvdXRlID09PSAnc2lnbkluJyAmJiBoaWRlU2lnblVwXCJcbiAgICAgID5cbiAgICAgICAgPGFtcGxpZnktc2lnbi1pbj48L2FtcGxpZnktc2lnbi1pbj5cbiAgICAgIDwvYW1wbGlmeS1zbG90PlxuXG4gICAgICA8IS0tIGNvbmZpcm1TaWduVXAgY29udGVudCAtLT5cbiAgICAgIDxhbXBsaWZ5LXNsb3RcbiAgICAgICAgbmFtZT1cImNvbmZpcm0tc2lnbi11cFwiXG4gICAgICAgIFtjb250ZXh0XT1cImNvbnRleHRcIlxuICAgICAgICAqbmdJZj1cInJvdXRlID09PSAnY29uZmlybVNpZ25VcCdcIlxuICAgICAgPlxuICAgICAgICA8YW1wbGlmeS1jb25maXJtLXNpZ24tdXA+PC9hbXBsaWZ5LWNvbmZpcm0tc2lnbi11cD5cbiAgICAgIDwvYW1wbGlmeS1zbG90PlxuXG4gICAgICA8IS0tIGNvbmZpcm1TaWduSW4gY29udGVudCAtLT5cbiAgICAgIDxhbXBsaWZ5LXNsb3RcbiAgICAgICAgbmFtZT1cImNvbmZpcm0tc2lnbi1pblwiXG4gICAgICAgIFtjb250ZXh0XT1cImNvbnRleHRcIlxuICAgICAgICAqbmdJZj1cInJvdXRlID09PSAnY29uZmlybVNpZ25JbidcIlxuICAgICAgPlxuICAgICAgICA8YW1wbGlmeS1jb25maXJtLXNpZ24taW4+PC9hbXBsaWZ5LWNvbmZpcm0tc2lnbi1pbj5cbiAgICAgIDwvYW1wbGlmeS1zbG90PlxuXG4gICAgICA8IS0tIHNldHVwVG90cCBjb250ZW50IC0tPlxuICAgICAgPGFtcGxpZnktc2xvdFxuICAgICAgICBuYW1lPVwic2V0dXAtdG90cFwiXG4gICAgICAgIFtjb250ZXh0XT1cImNvbnRleHRcIlxuICAgICAgICAqbmdJZj1cInJvdXRlID09PSAnc2V0dXBUb3RwJ1wiXG4gICAgICA+XG4gICAgICAgIDxhbXBsaWZ5LXNldHVwLXRvdHA+PC9hbXBsaWZ5LXNldHVwLXRvdHA+XG4gICAgICA8L2FtcGxpZnktc2xvdD5cblxuICAgICAgPCEtLSBmb3JjZU5ld1Bhc3N3b3JkIGNvbnRlbnQgLS0+XG4gICAgICA8YW1wbGlmeS1zbG90XG4gICAgICAgIG5hbWU9XCJmb3JjZS1uZXctcGFzc3dvcmRcIlxuICAgICAgICBbY29udGV4dF09XCJjb250ZXh0XCJcbiAgICAgICAgKm5nSWY9XCJyb3V0ZSA9PT0gJ2ZvcmNlTmV3UGFzc3dvcmQnXCJcbiAgICAgID5cbiAgICAgICAgPGFtcGxpZnktZm9yY2UtbmV3LXBhc3N3b3JkPjwvYW1wbGlmeS1mb3JjZS1uZXctcGFzc3dvcmQ+XG4gICAgICA8L2FtcGxpZnktc2xvdD5cblxuICAgICAgPCEtLSBmb3Jnb3RQYXNzd29yZCBjb250ZW50IC0tPlxuICAgICAgPGFtcGxpZnktc2xvdFxuICAgICAgICBuYW1lPVwiZm9yZ290LXBhc3N3b3JkXCJcbiAgICAgICAgW2NvbnRleHRdPVwiY29udGV4dFwiXG4gICAgICAgICpuZ0lmPVwicm91dGUgPT09ICdmb3Jnb3RQYXNzd29yZCdcIlxuICAgICAgPlxuICAgICAgICA8YW1wbGlmeS1mb3Jnb3QtcGFzc3dvcmQ+PC9hbXBsaWZ5LWZvcmdvdC1wYXNzd29yZD5cbiAgICAgIDwvYW1wbGlmeS1zbG90PlxuXG4gICAgICA8IS0tIGNvbmZpcm1SZXNldFBhc3N3b3JkIGNvbnRlbnQgLS0+XG4gICAgICA8YW1wbGlmeS1zbG90XG4gICAgICAgIG5hbWU9XCJjb25maXJtLXJlc2V0LXBhc3N3b3JkXCJcbiAgICAgICAgW2NvbnRleHRdPVwiY29udGV4dFwiXG4gICAgICAgICpuZ0lmPVwicm91dGUgPT09ICdjb25maXJtUmVzZXRQYXNzd29yZCdcIlxuICAgICAgPlxuICAgICAgICA8YW1wbGlmeS1jb25maXJtLXJlc2V0LXBhc3N3b3JkPjwvYW1wbGlmeS1jb25maXJtLXJlc2V0LXBhc3N3b3JkPlxuICAgICAgPC9hbXBsaWZ5LXNsb3Q+XG5cbiAgICAgIDwhLS0gdmVyaWZ5VXNlciBjb250ZW50IC0tPlxuICAgICAgPGFtcGxpZnktc2xvdFxuICAgICAgICBuYW1lPVwidmVyaWZ5LXVzZXJcIlxuICAgICAgICBbY29udGV4dF09XCJjb250ZXh0XCJcbiAgICAgICAgKm5nSWY9XCJyb3V0ZSA9PT0gJ3ZlcmlmeVVzZXInXCJcbiAgICAgID5cbiAgICAgICAgPGFtcGxpZnktdmVyaWZ5LXVzZXI+PC9hbXBsaWZ5LXZlcmlmeS11c2VyPlxuICAgICAgPC9hbXBsaWZ5LXNsb3Q+XG5cbiAgICAgIDwhLS0gY29uZmlybVZlcmlmeVVzZXIgY29udGVudCAtLT5cbiAgICAgIDxhbXBsaWZ5LXNsb3RcbiAgICAgICAgbmFtZT1cImNvbmZpcm0tdmVyaWZ5LXVzZXJcIlxuICAgICAgICBbY29udGV4dF09XCJjb250ZXh0XCJcbiAgICAgICAgKm5nSWY9XCJyb3V0ZSA9PT0gJ2NvbmZpcm1WZXJpZnlVc2VyJ1wiXG4gICAgICA+XG4gICAgICAgIDxhbXBsaWZ5LWNvbmZpcm0tdmVyaWZ5LXVzZXI+PC9hbXBsaWZ5LWNvbmZpcm0tdmVyaWZ5LXVzZXI+XG4gICAgICA8L2FtcGxpZnktc2xvdD5cbiAgICA8L2Rpdj5cblxuICAgIDxhbXBsaWZ5LXNsb3QgbmFtZT1cImZvb3RlclwiIFtjb250ZXh0XT1cImNvbnRleHRcIj48L2FtcGxpZnktc2xvdD5cbiAgPC9kaXY+XG48L2Rpdj5cblxuPCEtLSBzaWduZWRJbiBjb250ZW50IGlzIHJlbmRlcmVkIG91dHNpZGUgYXV0aGVudGljYXRvciBzbyBpdCdzIG5vdCBzdHlsZWQgYnkgYXV0aGVudGljYXRvciAtLT5cbjxhbXBsaWZ5LXNsb3RcbiAgbmFtZT1cImF1dGhlbnRpY2F0ZWRcIlxuICBbY29udGV4dF09XCJjb250ZXh0XCJcbiAgKm5nSWY9XCJyb3V0ZSA9PT0gJ2F1dGhlbnRpY2F0ZWQnXCJcbj5cbiAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuPC9hbXBsaWZ5LXNsb3Q+XG4iXX0=